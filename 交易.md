## 交易

#### 一. 交易的本质

- 交易是由外部账户发起的签名消息, 由以太坊网络传输, 并被序列化后记录在以太坊区块链上
- 交易是唯一可以触发状态更改或导致合约在EVM中执行的东西
- 以太坊是一个全局单例状态机, 交易是唯一可以改变其状态的东西
- 合约不是自己运行的, 以太坊也不会“在后台”运行, 以太坊上的一切变化都始于交易

#### 二. 交易的组成

- **组成**

  交易是包含以下数据的序列化二进制消息

  - **nonce**: 由发起人的EOA发出的序列号, 用于防止交易消息重播
    - 黄皮书定义: 一个表量值, 等于从这个地址发送的交易数, 或者对于关联code账户来说, 是这个账户创建合约的数量
    - **nonce**不会明确存储为区块链中账户状态的一部分; 相反, 他是通过计算发送地址的已确认交易数量来动态计算的
    - **nonce**值还用于防止错误计算账户余额, **nonce**强制来自任何地址的交易按顺序处理, 没有间隔, 无论节点接收他们的顺序如何
    - **nonce**确保所有节点计算相同的余额和正确的序列交易, 等同于用于防止比特币的“双重支付”(“重放攻击”)的机制.由于以太坊跟踪账户余额并且不单独跟踪UTXO, 因此只有在错误的计算账户余额时才会发生“双重支付”, **nonce**机制可以防止这种情况的发生
  - **gas price**: 交易发起人愿意支付的gas单价(wei)
  - **start price**: 交易发起人愿意支付的最大gas量
  - **to**: 目的以太坊地址
  - **value**: 要发送到目的以太坊地址的以太数量
  - **data**: 可变长度二进制数据负载(payload)
  - **v,r,s**: 发起人EOA的ECDSA签名的三个组成部分
  - 交易消息的结构使用递归长度前缀(RLP)编码方案进行序列化, 该方案专为在以太坊中准确和字节完美的数据序列化而创建

